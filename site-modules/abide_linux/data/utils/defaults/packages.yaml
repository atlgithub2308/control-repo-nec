---
abide_linux::utils::packages::linux::aide::defaults:
  control_package: true
  package_ensure: 'present'
  manage_config: true
  run_scheduled: true
  scheduler: 'systemd'
  systemd_timer_schedule: '*-*-* 00:00:00'
  systemd_service_content: |
    [Unit]
    Description=Aide Check
    [Service]
    Type=simple
    ExecStart=/usr/sbin/aide --check
    [Install]
    WantedBy=multi-user.target
  conf_purge: false
  conf_db_dir: /var/lib/aide
  conf_log_dir: /var/log/aide
  conf_verbosity: 5
  conf_report_urls:
    - 'file:@@{LOGDIR}/aide.log'
    - 'stdout'
  conf_rules:
    - 'PERMS = p+u+g+acl+xattrs'
    - 'CONTENT_EX = sha256+ftype+p+u+g+n+acl+xattrs'
  conf_checks:
    - '/boot/   CONTENT_EX'
    - '/bin/    CONTENT_EX'
    - '/sbin/   CONTENT_EX'
    - '/lib/    CONTENT_EX'
    - '/lib64/  CONTENT_EX'
    - '/opt/    CONTENT_EX'
    - '/root/\..* PERMS'
    - '/root/   CONTENT_EX'
    - '!/usr/src/'
    - '!/usr/tmp/'
    - '/usr/    CONTENT_EX'
    - '!/etc/mtab$'
    - '!/etc/.*~'
    - '/etc/hosts$ CONTENT_EX'
    - '/etc/passwd$   CONTENT_EX'
    - '/etc/group$    CONTENT_EX'
    - '/etc/gshadow$  CONTENT_EX'
    - '/etc/shadow$   CONTENT_EX'
    - '/etc/resolv.conf$ CONTENT_EX'
    - '/etc/login.defs$ CONTENT_EX'
    - '/etc/libuser.conf$ CONTENT_EX'
    - '/var/log/faillog$ PERMS'
    - '/var/log/lastlog$ PERMS'
    - '/var/run/faillock/ PERMS'
    - '/etc/pam.d/ CONTENT_EX'
    - '/etc/security$ CONTENT_EX'
    - '/etc/securetty$ CONTENT_EX'
    - '/etc/polkit-1/ CONTENT_EX'
    - '/etc/sudo.conf$ CONTENT_EX'
    - '/etc/sudoers$ CONTENT_EX'
    - '/etc/sudoers.d/ CONTENT_EX'
    - '!/var/log/sa/'
    - '!/var/log/aide.log'
    - '/etc/    PERMS'
    - '!/var/log/httpd/'
    - '!/opt/puppetlabs/puppet/cache/'
    - '!/opt/puppetlabs/puppet/public/last_run_summary.yaml'